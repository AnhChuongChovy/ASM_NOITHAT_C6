@page "/DanhMuc/{categoryId:int}"
@using WebAsemly_NoiThat.Model

<h2>@category?.TenDanhMuc</h2>

@if (category == null)
{
    <p>Loading...</p>
}
else
{
    @foreach (var categoryType in categoryTypes)
    {
        <h3>@categoryType.TenLoaiDanhMuc</h3>
        <ul>
            @foreach (var product in categoryType.Product)
            {
                <li>@product.TenSP - @product.Gia</li>
            }
        </ul>
    }
}

@code {
    [Parameter]
    public int categoryId { get; set; }

    private Category category;
    private List<CategoryType> categoryTypes;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var httpClient = new HttpClient();
            category = await httpClient.GetFromJsonAsync<Category>($"https://localhost:44320/api/Category/{categoryId}");
            if (category != null)
            {
                categoryTypes = category.CategoryType.ToList();
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading category: {ex.Message}");
        }
    }
}
